package com.paule.kitprod_api.controller;

import com.paule.kitprod_api.model.Charge;
import com.paule.kitprod_api.model.Exploitation;
import com.paule.kitprod_api.model.SequenceGeneratorService;
import com.paule.kitprod_api.repository.ExploitationRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
public class ExploitationController {

    @Autowired
    private SequenceGeneratorService sequenceGeneratorService;

    @Autowired
    public ExploitationRepository exploitationRepository;

    @GetMapping(value = "/exploitations")
    public List<Exploitation> getAllExploitations(@RequestParam Long idUser){
        return exploitationRepository.findAll();
    }

    @PostMapping(value = "/exploitations")
    public String createExploitation(@RequestBody Exploitation exploitation){
        exploitation.setId(sequenceGeneratorService.generateSequence(Exploitation.SEQUENCE_NAME));
        Exploitation insertedExploitation = exploitationRepository.insert(exploitation);
        return "Exploitation created:"+insertedExploitation.getName();
    }
}


